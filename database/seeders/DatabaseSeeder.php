<?php
/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	INCLUDES
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	namespace Database\Seeders;

	// Laravel
	use App;
	use Illuminate\Database\Seeder;
	use Illuminate\Support\Facades\Cache;
	use Illuminate\Support\Facades\Storage;



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	CLASS
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


class DatabaseSeeder extends Seeder
{



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	RUN
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	/**
	 * Run the database seeds and reset the cache and storage before. Depending on the environment, different seeders are called.
	 */

	public function run(): void {

		Cache::flush();

		// delete all folders and files in storage
		if(App::environment()=='local') {
			$folders = Storage::disk('public')->directories('/');
			foreach($folders as $folder) { Storage::disk('public')->deleteDirectory($folder); }
		}

		if(config('app.features.backend')) {
			$this->call(RolePermissionTableSeeder::class);
			$this->call(UserTableSeeder::class);
			$this->call(InsecurePasswordSeeder::class);
		}

		switch(App::Environment()) {
			case 'local': 		$this->call(LocalSeeder::class); break;
			case 'testing': 	$this->call(TestingSeeder::class); break;
		}
	}



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


} // end class
