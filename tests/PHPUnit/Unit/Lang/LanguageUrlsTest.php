<?php

/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//    INCLUDES
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	namespace Tests\PHPUnit\Unit\Lang;

	// Laravel
	use Tests\PHPUnit\TestCase;



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//    CLASS DECLARATION
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


class LanguageUrlsTest extends TestCase {



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//   DEFAULT LANGUAGE URLS
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	public function test_default_url() {

		// act
		$response = $this->get('/');

		// assert
		$response->assertSeeHtml('<html lang="de"');
		$response->assertSeeHtml('<link rel="canonical" href="'.config('app.url').'">');
	}


	public function test_forced_url() {

		// act
		$response = $this->get('/en');

		// assert
		$response->assertSeeHtml('<html lang="en"');
		$response->assertSeeHtml('<link rel="canonical" href="'.config('app.url').'en/">');
	}



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//   LANGUAGE FOR USER
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	public function test_default_url_with_default_user_lang() {

		// arrange
		$this->loginAsUser();

		// act
		$response = $this->get('/');

		// assert
		$response->assertSeeHtml('<html lang="de"');
		$response->assertSeeHtml('<link rel="canonical" href="'.config('app.url').'">');
	}


	public function test_default_url_with_other_user_lang() {

		// arrange
		$this->loginAsUser(['lang' => 'en']);

		// act
		$response = $this->get('/');

		// assert
		$response->assertRedirect('/en');
	}


	public function test_forced_url_with_other_user_lang() {

		// arrange
		$this->loginAsUser(['lang' => 'en']);

		// act
		$response = $this->get('/de');

		// assert
		$response->assertSeeHtml('<html lang="de"');
		$response->assertSeeHtml('<link rel="canonical" href="'.config('app.url').'de/">');
	}



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */

} // end class
