/// <reference types="cypress" />
/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	TESTS
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


describe('Login user', () => {


	it('correct env variable for password',()=>{

		// assert
		expect(Cypress.env('ROOT_PASSWORD')).to.be.a('string')
	});



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	LOGIN FORM
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	it('fill out form with invalid user data', () => {

		// act
		cy.appLogin(null, '12345678');

		// assert: error messages
		cy.get('p.error').should('to.exist');

		// assert: error styling
		cy.get('#input-email').should('have.class','error');
		cy.get('label[for="input-email"]').should('have.class','error');
	});


	it('fill out form with correct user data', () => {

		// act
		cy.appLogin();

		// assert
		cy.url().should('include', '/home');
	});


	it('automatic redirect from login to home if already logged in user', () => {

		// act
		cy.appLogin();
		cy.wait(3000);
		cy.visit('/login')

		// assert
		cy.url({timeout:5*1000}).should('include', '/home');
	});



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	LOGOUT
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	it('log out and block access to home', () => {

		// arrange
		cy.appLogin();
		cy.wait(3000);

		// act
		cy.get('.header-navi-item').contains('Logout').click();

		// assert
		cy.url({timeout:3*1000}).should('eq', Cypress.config('baseUrl') );
	});



/*/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


})
