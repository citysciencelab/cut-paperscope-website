/// <reference types="cypress" />
/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	TESTS
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


describe('Delete Project model in backend', () => {



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	DELETE PROJECT
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	it('delete from list', () => {

		// arrange: go to list page
		cy.backendLogin();
		cy.visit('/backend/project');
		cy.wait(2000);

		// arrange: find cypress test project
		var projectName;
		var project = cy.get('.data-list-item[data-draggable] a').filter(':contains("Cypress Test-Project")').first();
		project.should(target => projectName = target.text().trim());

		// click delete button
		project.parent().parent().find('.data-list-btn.delete').click();
		cy.wait(2000); // wait for async components

		// popup contains current name
		var popup = cy.get('.popup.modal');
		popup = popup.find('.modal-copy').should(target => {
			expect(target).to.contain(projectName);
		});

		// confirm delete
		cy.get('.popup.modal').find('.btn-confirm').click();

		// assert project missing in list
		cy.wait(2000); // wait for list to update
		cy.get('.data-list-item[data-draggable] a').then(e => cy.get(e).filter(':contains("'+projectName+' - edited")').should('not.exist'));
	});



/*/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


})
