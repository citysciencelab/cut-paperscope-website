/// <reference types="cypress" />
/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	TESTS
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


describe('Delete Item model in backend', () => {


/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	DELETE ITEM
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	it('delete from list', () => {

		// arrange: go to list page
		cy.backendLogin();
		cy.visit('/backend/item');
		cy.wait(2000);

		// arrange: find cypress test item
		var itemName;
		var item = cy.get('.data-list-item[data-draggable] a').filter(':contains("Cypress Test-Item")').first();
		item.should(target => itemName = target.text().trim());

		// click delete button
		item.parent().parent().find('.data-list-btn.delete').click();
		cy.wait(2000); // wait for async components

		// popup contains current name
		var popup = cy.get('.popup.modal');
		popup = popup.find('.modal-copy').should(target => {
			expect(target).to.contain(itemName);
		});

		// confirm delete
		cy.get('.popup.modal').find('.btn-confirm').click();

		// assert item missing in list
		cy.wait(2000); // wait for list to update
		cy.get('.data-list-item[data-draggable] a').then(e => cy.get(e).filter(':contains("'+itemName+' - edited")').should('not.exist'));
	});



/*/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


})
