<?php
/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	INCLUDES
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	namespace App\Http\Middleware;

	// App
	use Closure;
	use Illuminate\Http\Request;
	use Illuminate\Support\Facades\Auth;



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	CLASS DECLARATION
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


class VerifyBackendUser {


	public function handle(Request $request, Closure $next) {

		if(!Auth::user()->isBackendUser()) {

			if($request->expectsJson()) {
				return response()->json(['status' => 'error', 'message' => trans('api.unauthorized') ], 403);
			}
			else {
				return redirect('backend.login');
			}
		}

		return $next($request);
	}



/*/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


}
