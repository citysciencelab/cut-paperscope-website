<?php
/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//    INLCUDES
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	namespace App\Http\Middleware;

	// Laravel
	use Closure;
	use Illuminate\Http\Request;
	use Illuminate\Support\Facades\Auth;
	use Symfony\Component\HttpFoundation\Response;



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//    CLASS CONSTRUCT
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


class RedirectIfAuthenticated {


	// Handle an incoming request.
	public function handle(Request $request, Closure $next, string ...$guards): Response {

		$guards = empty($guards) ? [null] : $guards;

		foreach ($guards as $guard) {

			if (Auth::guard($guard)->check()) {

				// check for ajax request
	 			if ($request->expectsJson()) { return response()->json(['status'=>'success', 'message' => 'authenticated.'], 200); }
	  			else { return redirect( config('fortify.home') ); }
			}
		}

		return $next($request);
	}



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


} // end class

