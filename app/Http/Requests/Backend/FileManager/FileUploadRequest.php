<?php
/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	INCLUDE
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	namespace App\Http\Requests\Backend\FileManager;

	// Laravel
	use Illuminate\Support\Facades\Auth;

	// App
	use App\Http\Requests\BaseFormRequest;



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	CLASS
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


class FileUploadRequest extends BaseFormRequest {


	public function authorize(): bool {

		$user = Auth::user();
		return $user && $user->hasPermissionTo('create files');
	}



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	VALIDATE
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	public function rules(): array {

		return [

			'folder' => 			$this->rule('folder'),
			'storage' => 			$this->rule('storage'),
			'stream_offset' => 		'bail|required|string|in:78fb153f02e9d3a43b4e5a81273ed716=', // hidden id for validation,
			'file' => 				'bail|required|file|mimes:jpeg,jpg,png,gif,webp,svg|max:8192',
		];
	}



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	ERROR MESSAGES
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	// rename variables for form error messages
	public function attributes(): array {

		return [
			...parent::attributes(),
		];
	}


	public function messages(): array {

		return [
			...parent::messages(),
		];
	}



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


} // end class
