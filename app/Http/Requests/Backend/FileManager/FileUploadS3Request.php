<?php
/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	INCLUDE
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	namespace App\Http\Requests\Backend\FileManager;

	// Laravel
	use Illuminate\Support\Facades\Auth;

	// App
	use App\Http\Requests\BaseFormRequest;



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	CLASS
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


class FileUploadS3Request extends BaseFormRequest {


	public function authorize(): bool {

		$user = Auth::user();
		return $user && $user->hasPermissionTo('create files');
	}



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//	VALIDATE
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


	public function rules(): array {

		return [

			'filename' => 					'bail|required|string',
			'type' => 						'bail|required|string',
			'metadata.folder' => 			$this->rule('folder'),
			'metadata.stream_offset' => 	'bail|required|in:78fb153f02e9d3a43b4e5a81273ed716=', // hidden id for validation
		];
	}



/*///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// */


} // end class
