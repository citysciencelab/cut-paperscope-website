<!--/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//    HTML
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////-->


	<template>

		<section class="content">

			<h1>{{ product.title }}</h1>

			<!-- PENDING -->
			<div v-if="isPending" class="pending">
				<p>{{ t('payment.pending') }}</p>
				<btn :label="t('Seite neu laden')" @click="reload" class="small secondary"/>
			</div>

			<!-- PAID -->
			<div v-else v-html="product.content"></div>

		</section>

	</template>



<!--/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//    JAVASCRIPT
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////-->


	<script setup>

		import { ref } from 'vue';
		import { useRoute } from 'vue-router';
		import { useRouter } from 'vue-router';

		import { usePage } from '@global/composables/usePage';
		import { useApi } from '@global/composables/useApi';


		/////////////////////////////////
		// INIT
		/////////////////////////////////

		const { t } = usePage("Produkt");
		const route = useRoute();
		const router = useRouter();


		/////////////////////////////////
		// PRODUCT
		/////////////////////////////////

		const { apiGetResponse } = useApi();
		const product = ref({});
		const isPending = ref(false);

		apiGetResponse('product.paid',{slug: route.params.slug}, response => {

			if(response.status == 200) { product.value = response.data.data; }
			else if(response.status == 202) { isPending.value = true; }
		})
		.catch(e => router.push({name:'error.404'}) );


		function reload() { location.reload(); }


	</script>



<!--/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//    LANG
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////-->


	<i18n lang="json5">
		{
			"de": {
				"payment.pending": "Der Kauf wird noch bearbeitet.",
			},
			"en": {
				"payment.pending": "The purchase is still being processed.",
				"Seite neu laden": "reload page",
			}
		}
	</i18n>

