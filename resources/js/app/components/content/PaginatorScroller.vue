<!--/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//    HTML
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////-->


	<template>

		<div v-if="showElement" class="paginator-scroller" ref="root">
			<loading-spinner/>
		</div>

	</template>



<!--/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//    JAVASCRIPT
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////-->


	<script setup>

		import { useTemplateRef, computed, watch } from 'vue';


		/////////////////////////////////
		// INIT
		/////////////////////////////////

		const props = defineProps({
			paginator: { type: Object, default: undefined },
		});

		const emit = defineEmits(['update']);

		const showElement = computed(() => props.paginator?.currentPage < props.paginator?.pages);


		/////////////////////////////////
		// OBSERVER
		/////////////////////////////////

		const root = useTemplateRef('root');
		var observer = null;

		function initObserver() {

			const options = { rootMargin: '0px', threshold: 0 };

			observer = new IntersectionObserver(observerCallback, options);
			observer.observe(root.value);
		}


		function observerCallback(entries) {

			if(!entries[0].isIntersecting) { return; }

			const current = props.paginator.currentPage;
			const last = props.paginator.pages;

			if(current < last) { emit('update', current+1); }
		}


		watch(root, () => root.value ? initObserver() : null);


	</script>


